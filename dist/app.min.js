let pokemonRepository=function(){let e=[];function t(t){e=t}function o(){return e}function n(e){console.log("Showing details for:",e.name),console.log("Image URL:",e.imageUrl),console.log("Back Image URL:",e.backImageUrl),pokemonRepository.loadDetails(e).then(function(){var t,o,n,i,a;let l,r,s,c,p;t=e.name,o="Type: "+e.types.map(e=>e.type.name).join(", ")+"<br>Height: "+e.height+"<br>Weight: "+e.weight,n=e.imageUrl,i=e.description,a=e.backImageUrl,l=document.querySelector("#pokemonModalLabel"),document.querySelector(".modal-body"),r=document.querySelector("#pokemonHeight"),s=document.querySelector("#pokemonImage"),c=document.querySelector("#pokemonBackImage"),p=document.querySelector("#pokemonDescription"),l.innerText=t,r.innerHTML=o,s.setAttribute("src",n),c.setAttribute("src",a),p.innerHTML=i||"No description available.",$("#pokemonModal").modal("show")}).catch(function(e){console.error("Error loading details",e)})}async function i(){try{let e=await fetch("https://pokeapi.co/api/v2/pokemon/?limit=151"),t=await e.json(),o=t.results.map(async e=>{let t={name:e.name,detailsUrl:e.url,evolutionChain:null};return await a(t),t}),n=await Promise.all(o);pokemonRepository.setList(n),displayPokemon(n)}catch(i){console.error("Error loading the Pok\xe9mon list",i)}}async function a(e){try{let t=e.detailsUrl,o=await fetch(t),n=await o.json();e.imageUrl=n.sprites.front_default,e.backImageUrl=n.sprites.back_default,e.height=n.height,e.types=n.types,e.weight=n.weight,e.abilities=n.abilities;let i=await fetch(n.species.url),a=await i.json(),l=a.flavor_text_entries.find(e=>"en"===e.language.name);e.description=l?l.flavor_text:"No description available.";let r=a.evolution_chain.url,s=await fetch(r),c=await s.json();e.evolutionChain=c.chain}catch(p){console.error("Error fetching details",p)}}return{add:function t(o){"object"==typeof o&&"name"in o?e.push(o):console.log("pokemon is not correct")},getAll:o,addListItem:function e(t){let o=document.querySelector(".pokemon-list"),i=document.createElement("li");i.classList.add("list-group-item");let a=document.createElement("button");a.classList.add("btn","btn-primary","pokemon-button");let l=document.createElement("span");l.classList.add("pokemon-name"),l.innerText=t.name,a.appendChild(l);let r=document.createElement("img");r.setAttribute("src",t.imageUrl),r.setAttribute("alt",t.name+" image"),r.setAttribute("class","pokemon-image"),a.appendChild(r),a.addEventListener("click",function(){n(t)}),i.appendChild(a),o.appendChild(i)},loadList:i,loadDetails:a,setList:t,groupByEvolution:function e(t){let o=[];return t.forEach(e=>{(function e(t,o){for(let n of t)if(n[0].evolutionChain.species.name===o.species.name)return n;let i=[];return t.push(i),i})(o,e.evolutionChain).push(e)}),o},showDetails:n}}();function searchPokemon(e){let t=pokemonRepository.getAll(),o=t.filter(t=>t.name.toLowerCase().includes(e.toLowerCase()));displayPokemon(o)}async function displayPokemon(e){let t=document.querySelector(".pokemon-list");t.innerHTML="";let o=pokemonRepository.groupByEvolution(e);o.forEach(e=>{let o=document.createElement("div");o.classList.add("row"),e.forEach(e=>{let t=document.createElement("li");t.classList.add("list-group-item");let n=document.createElement("button");n.classList.add("btn","btn-primary","pokemon-button");let i=document.createElement("span");i.innerText=e.name,n.appendChild(i);let a=document.createElement("img");a.setAttribute("src",e.imageUrl),a.setAttribute("alt",e.name+" image"),a.setAttribute("class","pokemon-image"),n.appendChild(a),n.addEventListener("click",()=>pokemonRepository.showDetails(e)),t.appendChild(n),o.appendChild(t)}),t.appendChild(o)})}function filterByType(e){console.log("Filtering by type:",e);displayPokemon(pokemonRepository.getAll().filter(t=>t.types.some(t=>t.type.name.toLowerCase()===e.toLowerCase()))),highlightActiveType(e)}function highlightActiveType(e){document.querySelectorAll(".nav-link").forEach(t=>{t.innerText.toLowerCase()===e?t.classList.add("active"):t.classList.remove("active")})}function showAllPokemon(){highlightActiveType("");document.querySelector(".pokemon-list").innerHTML="",pokemonRepository.loadList().then(function(){pokemonRepository.getAll().forEach(function(e){pokemonRepository.addListItem(e)})})}document.querySelector("#searchInput").addEventListener("input",function(e){let t=e.target.value;t?searchPokemon(t):showAllPokemon()}),document.querySelector("#searchInput").addEventListener("keydown",function(e){if("Enter"===e.key){let t=document.querySelector(".navbar-collapse");t.classList.add("collapse")}}),pokemonRepository.loadList().then(function(){pokemonRepository.getAll().forEach(function(e){pokemonRepository.addListItem(e)})}),document.addEventListener("DOMContentLoaded",function(){pokemonRepository.loadList().then(function(){let e=pokemonRepository.getAll();displayPokemon(e)})}),document.querySelector("#grassTypeLink").addEventListener("click",function(e){e.preventDefault(),filterByType("grass"),highlightActiveType("grass")}),document.querySelector("#fireTypeLink").addEventListener("click",function(e){e.preventDefault(),filterByType("fire"),highlightActiveType("fire")}),document.querySelector("#waterTypeLink").addEventListener("click",function(e){e.preventDefault(),filterByType("water"),highlightActiveType("water")}),document.querySelector("#allPokemonLink").addEventListener("click",function(e){e.preventDefault(),highlightActiveType(""),showAllPokemon()});const navbar=document.querySelector(".navbar"),navbarToggler=document.querySelector(".navbar-toggler"),navbarCollapse=document.querySelector(".navbar-collapse");navbarToggler.addEventListener("click",function(e){e.stopPropagation(),navbarCollapse.classList.toggle("collapse")}),document.addEventListener("click",function(e){navbar.contains(e.target)||navbarCollapse.classList.contains("collapse")||navbarCollapse.classList.add("collapse")}),navbar.addEventListener("click",function(e){e.stopPropagation()});